MALE_SDH_8_FUNCTION <- function(AGE,
                                WEALTH_IMP,
                                PC_EDUCATION_LOW_IMP,
                                PC_EDUCATION_INTERMEDIATE_IMP,
                                PC_EDUCATION_HIGH_IMP,
                                PC_PM25) {
  # Standardisation
  
  AGE_STD <- (AGE - 55.6382) / 8.3622 
  WEALTH_IMP_STD <- (WEALTH_IMP - 48.0596) / 10.7210
  PC_EDUCATION_LOW_IMP_STD <- (PC_EDUCATION_LOW_IMP - 71.7705) / 24.4558
  PC_EDUCATION_INTERMEDIATE_IMP_STD <- (PC_EDUCATION_INTERMEDIATE_IMP - 44.1414) / 21.4385
  PC_EDUCATION_HIGH_IMP_STD <- (PC_EDUCATION_HIGH_IMP - 35.9869) / 26.6516
  PC_PM25_STD <- (PC_PM25 - 59.5623) / 26.0015
  
  # SES
  
  SES <- 0.4819 * WEALTH_IMP_STD +
        -0.5411 * PC_EDUCATION_LOW_IMP_STD +
        -0.3451 * PC_EDUCATION_INTERMEDIATE_IMP_STD +
         0.5964 * PC_EDUCATION_HIGH_IMP_STD
  
  # Non-linear terms
  
  DATA_D_MALE_AGE_STD_T1 <- -1.611008
  DATA_D_MALE_AGE_STD_T2 <- -0.7340432
  DATA_D_MALE_AGE_STD_T3 <- -0.00656125
  DATA_D_MALE_AGE_STD_T4 <- 0.7607827
  DATA_D_MALE_AGE_STD_T5 <- 1.577954
  
  AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T1_TRP3 <- (AGE_STD - DATA_D_MALE_AGE_STD_T1) ** 3
  AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T1_TRP3 <- ifelse(AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T1_TRP3 <= 0,
                                                      0,
                                                      AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T1_TRP3)
  AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T2_TRP3 <- (AGE_STD - DATA_D_MALE_AGE_STD_T2) ** 3
  AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T2_TRP3 <- ifelse(AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T2_TRP3 <= 0,
                                                      0,
                                                      AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T2_TRP3)
  AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T3_TRP3 <- (AGE_STD - DATA_D_MALE_AGE_STD_T3) ** 3
  AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T3_TRP3 <- ifelse(AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T3_TRP3 <= 0,
                                                      0,
                                                      AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T3_TRP3)
  AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T4_TRP3 <- (AGE_STD - DATA_D_MALE_AGE_STD_T4) ** 3
  AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T4_TRP3 <- ifelse(AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T4_TRP3 <= 0,
                                                      0,
                                                      AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T4_TRP3)
  AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T5_TRP3 <- (AGE_STD - DATA_D_MALE_AGE_STD_T5) ** 3
  AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T5_TRP3 <- ifelse(AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T5_TRP3 <= 0,
                                                      0,
                                                      AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T5_TRP3)
  
  AGE_STD_TAU <- (DATA_D_MALE_AGE_STD_T5 - DATA_D_MALE_AGE_STD_T1) ** 2
  
  AGE_STD_RCS5K_2 <- (AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T1_TRP3 - AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T4_TRP3 * (DATA_D_MALE_AGE_STD_T5 - DATA_D_MALE_AGE_STD_T1) / (DATA_D_MALE_AGE_STD_T5 - DATA_D_MALE_AGE_STD_T4) + AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T5_TRP3  * (DATA_D_MALE_AGE_STD_T4 - DATA_D_MALE_AGE_STD_T1) / (DATA_D_MALE_AGE_STD_T5 - DATA_D_MALE_AGE_STD_T4)) / AGE_STD_TAU
  AGE_STD_RCS5K_3 <- (AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T2_TRP3 - AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T4_TRP3 * (DATA_D_MALE_AGE_STD_T5 - DATA_D_MALE_AGE_STD_T2) / (DATA_D_MALE_AGE_STD_T5 - DATA_D_MALE_AGE_STD_T4) + AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T5_TRP3  * (DATA_D_MALE_AGE_STD_T4 - DATA_D_MALE_AGE_STD_T2) / (DATA_D_MALE_AGE_STD_T5 - DATA_D_MALE_AGE_STD_T4)) / AGE_STD_TAU
  AGE_STD_RCS5K_4 <- (AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T3_TRP3 - AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T4_TRP3 * (DATA_D_MALE_AGE_STD_T5 - DATA_D_MALE_AGE_STD_T3) / (DATA_D_MALE_AGE_STD_T5 - DATA_D_MALE_AGE_STD_T4) + AGE_STD_MINUS_DATA_D_MALE_AGE_STD_T5_TRP3  * (DATA_D_MALE_AGE_STD_T4 - DATA_D_MALE_AGE_STD_T3) / (DATA_D_MALE_AGE_STD_T5 - DATA_D_MALE_AGE_STD_T4)) / AGE_STD_TAU
  
  DATA_D_MALE_SES_2014_T1 <- -2.151085
  DATA_D_MALE_SES_2014_T2 <- -1.344966
  DATA_D_MALE_SES_2014_T3 <- -0.1849183
  DATA_D_MALE_SES_2014_T4 <- 1.057879
  DATA_D_MALE_SES_2014_T5 <- 2.870147
  
  SES_MINUS_DATA_D_MALE_SES_2014_T1_TRP3 <- (SES - DATA_D_MALE_SES_2014_T1) ** 3
  SES_MINUS_DATA_D_MALE_SES_2014_T1_TRP3 <- ifelse(SES_MINUS_DATA_D_MALE_SES_2014_T1_TRP3 <= 0,
                                                   0,
                                                   SES_MINUS_DATA_D_MALE_SES_2014_T1_TRP3)
  SES_MINUS_DATA_D_MALE_SES_2014_T2_TRP3 <- (SES - DATA_D_MALE_SES_2014_T2) ** 3
  SES_MINUS_DATA_D_MALE_SES_2014_T2_TRP3 <- ifelse(SES_MINUS_DATA_D_MALE_SES_2014_T2_TRP3 <= 0,
                                                   0,
                                                   SES_MINUS_DATA_D_MALE_SES_2014_T2_TRP3)
  SES_MINUS_DATA_D_MALE_SES_2014_T3_TRP3 <- (SES - DATA_D_MALE_SES_2014_T3) ** 3
  SES_MINUS_DATA_D_MALE_SES_2014_T3_TRP3 <- ifelse(SES_MINUS_DATA_D_MALE_SES_2014_T3_TRP3 <= 0,
                                                   0,
                                                   SES_MINUS_DATA_D_MALE_SES_2014_T3_TRP3)
  SES_MINUS_DATA_D_MALE_SES_2014_T4_TRP3 <- (SES - DATA_D_MALE_SES_2014_T4) ** 3
  SES_MINUS_DATA_D_MALE_SES_2014_T4_TRP3 <- ifelse(SES_MINUS_DATA_D_MALE_SES_2014_T4_TRP3 <= 0,
                                                   0,
                                                   SES_MINUS_DATA_D_MALE_SES_2014_T4_TRP3)
  SES_MINUS_DATA_D_MALE_SES_2014_T5_TRP3 <- (SES - DATA_D_MALE_SES_2014_T5) ** 3
  SES_MINUS_DATA_D_MALE_SES_2014_T5_TRP3 <- ifelse(SES_MINUS_DATA_D_MALE_SES_2014_T5_TRP3 <= 0,
                                                   0,
                                                   SES_MINUS_DATA_D_MALE_SES_2014_T5_TRP3)
  
  SES_TAU <- (DATA_D_MALE_SES_2014_T5 - DATA_D_MALE_SES_2014_T1) ** 2
  
  SES_RCS5K_2 <- (SES_MINUS_DATA_D_MALE_SES_2014_T1_TRP3 - SES_MINUS_DATA_D_MALE_SES_2014_T4_TRP3 * (DATA_D_MALE_SES_2014_T5 - DATA_D_MALE_SES_2014_T1) / (DATA_D_MALE_SES_2014_T5 - DATA_D_MALE_SES_2014_T4) + SES_MINUS_DATA_D_MALE_SES_2014_T5_TRP3  * (DATA_D_MALE_SES_2014_T4 - DATA_D_MALE_SES_2014_T1) / (DATA_D_MALE_SES_2014_T5 - DATA_D_MALE_SES_2014_T4)) / SES_TAU
  SES_RCS5K_3 <- (SES_MINUS_DATA_D_MALE_SES_2014_T2_TRP3 - SES_MINUS_DATA_D_MALE_SES_2014_T4_TRP3 * (DATA_D_MALE_SES_2014_T5 - DATA_D_MALE_SES_2014_T2) / (DATA_D_MALE_SES_2014_T5 - DATA_D_MALE_SES_2014_T4) + SES_MINUS_DATA_D_MALE_SES_2014_T5_TRP3  * (DATA_D_MALE_SES_2014_T4 - DATA_D_MALE_SES_2014_T2) / (DATA_D_MALE_SES_2014_T5 - DATA_D_MALE_SES_2014_T4)) / SES_TAU
  SES_RCS5K_4 <- (SES_MINUS_DATA_D_MALE_SES_2014_T3_TRP3 - SES_MINUS_DATA_D_MALE_SES_2014_T4_TRP3 * (DATA_D_MALE_SES_2014_T5 - DATA_D_MALE_SES_2014_T3) / (DATA_D_MALE_SES_2014_T5 - DATA_D_MALE_SES_2014_T4) + SES_MINUS_DATA_D_MALE_SES_2014_T5_TRP3  * (DATA_D_MALE_SES_2014_T4 - DATA_D_MALE_SES_2014_T3) / (DATA_D_MALE_SES_2014_T5 - DATA_D_MALE_SES_2014_T4)) / SES_TAU
  
  DATA_D_MALE_PC_PM25_2014_STD_T1 <- -1.752299
  DATA_D_MALE_PC_PM25_2014_STD_T2 <- -0.5985177
  DATA_D_MALE_PC_PM25_2014_STD_T3 <- 0.09375118
  DATA_D_MALE_PC_PM25_2014_STD_T4 <- 0.7475607
  DATA_D_MALE_PC_PM25_2014_STD_T5 <- 1.40137
  
  PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T1_TRP3 <- (PC_PM25_STD - DATA_D_MALE_PC_PM25_2014_STD_T1) ** 3
  PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T1_TRP3 <- ifelse(PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T1_TRP3 <= 0,
                                                                   0,
                                                                   PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T1_TRP3)
  PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T2_TRP3 <- (PC_PM25_STD - DATA_D_MALE_PC_PM25_2014_STD_T2) ** 3
  PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T2_TRP3 <- ifelse(PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T2_TRP3 <= 0,
                                                                   0,
                                                                   PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T2_TRP3)
  PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T3_TRP3 <- (PC_PM25_STD - DATA_D_MALE_PC_PM25_2014_STD_T3) ** 3
  PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T3_TRP3 <- ifelse(PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T3_TRP3 <= 0,
                                                                   0,
                                                                   PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T3_TRP3)
  PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T4_TRP3 <- (PC_PM25_STD - DATA_D_MALE_PC_PM25_2014_STD_T4) ** 3
  PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T4_TRP3 <- ifelse(PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T4_TRP3 <= 0,
                                                                   0,
                                                                   PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T4_TRP3)
  PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T5_TRP3 <- (PC_PM25_STD - DATA_D_MALE_PC_PM25_2014_STD_T5) ** 3
  PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T5_TRP3 <- ifelse(PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T5_TRP3 <= 0,
                                                                   0,
                                                                   PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T5_TRP3)
  
  PC_PM25_STD_TAU <- (DATA_D_MALE_PC_PM25_2014_STD_T5 - DATA_D_MALE_PC_PM25_2014_STD_T1) ** 2
  
  PC_PM25_STD_RCS5K_2 <- (PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T1_TRP3 - PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T4_TRP3 * (DATA_D_MALE_PC_PM25_2014_STD_T5 - DATA_D_MALE_PC_PM25_2014_STD_T1) / (DATA_D_MALE_PC_PM25_2014_STD_T5 - DATA_D_MALE_PC_PM25_2014_STD_T4) + PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T5_TRP3  * (DATA_D_MALE_PC_PM25_2014_STD_T4 - DATA_D_MALE_PC_PM25_2014_STD_T1) / (DATA_D_MALE_PC_PM25_2014_STD_T5 - DATA_D_MALE_PC_PM25_2014_STD_T4)) / PC_PM25_STD_TAU
  PC_PM25_STD_RCS5K_3 <- (PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T2_TRP3 - PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T4_TRP3 * (DATA_D_MALE_PC_PM25_2014_STD_T5 - DATA_D_MALE_PC_PM25_2014_STD_T2) / (DATA_D_MALE_PC_PM25_2014_STD_T5 - DATA_D_MALE_PC_PM25_2014_STD_T4) + PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T5_TRP3  * (DATA_D_MALE_PC_PM25_2014_STD_T4 - DATA_D_MALE_PC_PM25_2014_STD_T2) / (DATA_D_MALE_PC_PM25_2014_STD_T5 - DATA_D_MALE_PC_PM25_2014_STD_T4)) / PC_PM25_STD_TAU
  PC_PM25_STD_RCS5K_4 <- (PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T3_TRP3 - PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T4_TRP3 * (DATA_D_MALE_PC_PM25_2014_STD_T5 - DATA_D_MALE_PC_PM25_2014_STD_T3) / (DATA_D_MALE_PC_PM25_2014_STD_T5 - DATA_D_MALE_PC_PM25_2014_STD_T4) + PC_PM25_STD_MINUS_DATA_D_MALE_PC_PM25_2014_STD_T5_TRP3  * (DATA_D_MALE_PC_PM25_2014_STD_T4 - DATA_D_MALE_PC_PM25_2014_STD_T3) / (DATA_D_MALE_PC_PM25_2014_STD_T5 - DATA_D_MALE_PC_PM25_2014_STD_T4)) / PC_PM25_STD_TAU
  
  # Linear predictor
  
  LP <- 1.4548 * AGE_STD +
       -3.4572 * AGE_STD_RCS5K_2 +
        10.0237 * AGE_STD_RCS5K_3 + 
       -10.2369 * AGE_STD_RCS5K_4 + 
       -0.2900 * SES +
        1.2026 * SES_RCS5K_2 +
       -1.8944 * SES_RCS5K_3 +
        0.4418 * SES_RCS5K_4 +
        0.1869 * PC_PM25_STD +
       -0.5651 * PC_PM25_STD_RCS5K_2 +
        3.4596 * PC_PM25_STD_RCS5K_3 +
       -7.1875 * PC_PM25_STD_RCS5K_4
  
  # Predicted risk 
  
  PRED_RISK <- 1 - 0.9357485 ** exp(LP) 
  
  # Return
  
  return(PRED_RISK)
}
